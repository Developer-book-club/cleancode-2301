# Chapter 17. 냄새와 휴리스틱

#### 주석

##### __ C1: 부적절한 정보
- 다른 시스템(ex. 소스 코드 관리 시스템, 버그 추적 시스템, 이슈 추적 시스템, 기타 기록 관리 시스템)에 저장할 정보는 주석으로 적절하지 못하다.
- 주석은 코드와 설계에 기술적인 설명을 부연하는 수단이다.

##### __ C2: 쓸모 없는 주석

##### __ C3: 중복된 주석
- 코드만으로 충분한데 구구절절 설며아는 주석이 중복된 주석이다.

##### __ C4: 성의 없는 주석

##### __ C5: 주석 처리된 코드
- 즉각 지워버려라! 소스 코드 관리 시스템이 기억한다.

#### 환경

##### __ E1: 여러 단계로 빌드해야 한다
- 빌드는 간단히 한 단계로 끝나야 한다. 각 요소를 잇달아 실행해 따로 빌드할 필요가 없어야 한다.

##### __ E2: 여러 단계로 테스트해야 한다
- 모든 단위 테스트는 한 명령으로 돌려야 한다.

#### 함수

##### __ F1: 너무 많은 인수
- 함수에서 인수 개수는 작을수록 좋다. 아예 없으면 가장 좋다.

##### __ F2: 출력 인수
- 함수에서 뭔가의 상태를 변경해야 한다면 (출력 인수를 쓰지 말고) 함수가 속한 객체의 상태를 변경한다.

##### __ F3: 플래그 인수
- boolean 인수는 함수가 여러 기능을 수행한다는 명백한 증거다. 플래그 인수는 혼란을 초래하므로 치해야 마땅하다.

##### __ F4: 죽은 함수
- 아무도 호출하지 않는 함수는 삭제한다.

#### 일반

##### __ G1: 한 소스 파일에 여러 언어를 사용한다
- 이상적으로는 소스 파일 하나에 언어 하나만 사용하는 방식이 가장 좋다.

##### __ G2: 당연한 동작을 구현하지 않는다
- 함수나 클래스는 다른 프로그래머가 당연하게 여길 만한 동작과 기능을 제공해야 한다.

##### __ G3: 경계를 올바로 처리하지 않는다
- 모든 예외는 우아하고 직관적인 알고리즘을 좌초시킬 암초다. 스스로의 직관에 의존하지 마라. 
- 모든 경계 조건을 찾아내고, 모든 경계 조건을 테스트하는 테스트 케이스를 작성하라.

##### __ G4: 안전 절차 무시
- 실패하는 테스트 케이스를 나중으로 미루는 태도는 위험하다.

##### __ G5: 중복
- DRY(Don't Repeat Yourself!) 원칙
- 코드에서 중복을 발견할 때마다 추상화할 기회로 간주하라. 중복된 코드를 하위 루틴이나 다른 클래스로 분리하라.
- 똑같은 코드가 여러 차례 나오는 중복은 간단한 함수로 교체하라.
- 여러 모듈에서 switch/case나 if/else문으로 똑같은 조건을 거듭 확인하는 중복은 다형성(polymorphism)으로 대체하라.
- 알고리즘이 유사하나 코드가 서로 다른 중복은 Template Method 패턴이나 Strategy 패턴으로 중복을 제거하라.
- 디자인 패턴은 중복을 제거하는 잘 알려진 방법이다.

##### __ G6: 추상화 수준이 올바르지 못하다
- 추상화는 저차원 상세 개념에서 고차원 일반 개념을 분리한다.
- 모든 저차원 개념은 파생 클래스에 넣고, 모든 고차원 개념은 기초 클래스에 넣는다.
- 세부 구현과 관련한 상수, 변수, 유틸리티 함수는 기초 클래스에 넣으면 안 된다. 기초 클래스는 구현 정보에 무지해야 마땅하다.

##### __ G7: 기초 클래스가 파생 클래스에 의존한다
- 기초/파생 클래스를 나누는 이유는 고차원 기초 클래스 개념을 저차원 파생 클래스 개념으로부터 분리해 독립성을 보장하기 위해서다.
- 기초 클래스는 파생 클래스를 아예 몰라야 마땅하다.

##### __ G8: 과도한 정보
- 잘 정의된 인터페이스는 많은 함수를 제공하지 않는다. 그래서 결합도가 낮다.
- 우수한 개발자는 클래스나 모듈 인터페이스에 노출할 함수를 제한할 줄 알아야 한다.
- 클래스가 제공하는 메서드 수는 작을수록 좋다. 함수가 아는 변수 수도 작을수록 좋다. 클래스에 들어있는 인스턴스 변수 수도 작을수록 좋다.
- 자료를 숨겨라. 유틸리티 함수를 숨겨라. 상수와 임시 변수를 숨겨라. 메서드나 인스턴스 변수가 넘쳐나는 클래스는 피하라.
- 하위 클래스에서 필요하다는 이유로 protected 변수나 함수를 마구 생성하지 마라.

##### __ G9: 죽은 코드
- 죽은 코드는 실행되지 않는 코드를 가리킨다.

##### __ G10: 수직 분리
- 변수와 함수는 사용되는 위치에 가깝게 정의한다.
- 비공개 함수는 처음으로 호출한 직후에 정의한다.

##### __ G11: 일관성 부족

##### __ G12: 잡동사니

##### __ G13: 인위적 결합
- 서로 무관한 개념을 인위적으로 결합하지 않는다.

##### __ G14: 기능 욕심

##### __ G15: 선택자 인수
- 함수 동작을 제어하려는 인수는 하나 같이 바람직하지 않다.
- 일반적으로, 인수를 넘겨 동작을 선택하는 대신 새로운 함수를 만드는 편이 좋다.

##### __ G16: 모호한 의도
- 코드를 짤 때는 의도를 최대한 분명히 밝힌다.

##### __ G17: 잘못 지운 책임

##### __ G18: 부적절한 static 함수
- static 함수는 override(재정의)할 가능성이 전혀 없는 함수에만 사용하라.

##### __ G19: 서술적 변수

##### __ G20: 이름과 기능이 일치하는 함수

##### __ G21: 알고리즘을 이해하라

##### __ G22: 논리적 의존성은 물리적으로 드러내라

##### __ G23: If/Else 혹은 Switch/Case 문보다 다형성을 사용하라

##### __ G24: 표준 표기법을 따르라

##### __ G25: 매직 숫자는 명명된 상수로 교체하라

##### __ G26: 정확하라
- 예외 처리할 방법을 알아야 한다.
- null을 반환할지도 모른다면 null을 반드시 점검한다.
- 병행 특성으로 인해 동시에 갱신할 가능성이 있다면 적절한 잠금 매커니즘을 구현한다.

##### __ G27: 관례보다 구조를 사용하라

##### __ G28: 조건을 캡슐화하라

##### __ G29: 부정 조건은 피하라
- 가능하면 긍정 조건으로 표현한다.

##### __ G30: 함수는 한 가지만 해야 한다

##### __ G31: 숨겨진 시간적인 결합
- 시간적인 결합을 노출한다.
```java
public void dive(String reason)
{
  Gradient gradient = saturateGradient();
  List<Spline> splines = reticulateSplines(gradient);
  diveForMoog(splines, reason);
}
```

##### __ G32: 일관성을 유지하라

##### __ G33: 경계 조건을 캡슐화하라
- 경계 조건은 한 곳에서 별도로 처리한다.

##### __ G34: 함수는 추상화 수준을 한 단계만 내려가야 한다
- 함수 내 모든 문장은 추상화 수준이 동일해야 한다. 그리고 그 추상화 수준은 함수 이름이 의미하는 작업보다 한 단계만 낮아야 한다.

##### __ G35: 설정 정보는 최상위 단계에 둬라
- 설정 관련 상수는 최상위 단계에 둔다. 설정 관련 변수는 나머지 코드에 인수로 넘긴다.

##### __ G36: 추이적 탐색을 피하라
- 일반적으로 한 모듈은 주변 모듈을 모를수록 좋다.
#### 자바

##### __ J1: 긴 import 목록을 피하고 와일드카드를 사용하라
```java
import package.*;
```

##### __ J2: 상수는 상속하지 않는다
```java
import static PayrollConstants.*;
```

##### __ J3: 상수 대 Enum

#### 이름

##### __ N1: 서술적인 이름을 사용하라

##### __ N2: 적절한 추상화 수준에서 이름을 선택하라
- 구현을 드러내는 이름은 피하라. 작업 대상 클래스나 함수가 위치하는 추상화 수준을 반영하는 이름을 선택하라.

##### __ N3: 가능하다면 표준 명명법을 사용하

##### __ N4: 명확한 이름

##### __ N5: 긴 범위는 긴 이름을 사용하라

##### __ N6: 인코딩을 피하라
- 이름에 유형 정보나 범위 정보를 넣어서는 안 된다.

##### __ N7: 이름으로 부수 효과를 설명하라

#### 테스트

##### __ T1: 불충분한 테스트
- 테스트 케이스는 잠재적으로 깨질 만한 부분을 모두 테스트해야 한다.

##### __ T2: 커버리지 도구를 사용하라!

##### __ T3: 사소한 테스트를 건너뛰지 마라

##### __ T4: 무시한 테스트는 모호함을 뜻한다
- 불분명한 요구사항은 테스트 케이스를 주석으로 처리하거나 테스트 케이스에 @Ignore를 붙여 표현한다.

##### __ T5: 경계 조건을 테스트하라

##### __ T6: 버그 주변은 철저히 테스트하라

##### __ T7: 실패 패턴을 살펴라

##### __ T8: 테스트 커버리지 패턴을 살펴라

##### __ T9: 테스트는 빨라야 한다

#### 결론
